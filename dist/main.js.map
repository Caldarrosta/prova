{"version":3,"file":"main.js","sourceRoot":"","sources":["../src/main.ts"],"names":[],"mappings":";;;;;;;;;AAgBA,MAAM,YAAY,GAAG,EAAE,CAAC;AACxB,MAAM,gBAAgB,GAAG,GAAG,CAAC;AAK7B,MAAM,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,CAAC,CAAC,EAAE;IAC5C,IAAI,EAAE,CAAC;AACX,CAAC,CAAC,CAAC;AAGH,IAAI,IAAgB,CAAC;AACrB,IAAI,UAAuB,CAAC;AAC5B,IAAI,cAA2B,CAAC;AAChC,IAAI,aAA0B,CAAC;AAC/B,IAAI,aAA0B,CAAC;AAC/B,IAAI,YAAY,GAAG,CAAC,CAAC;AAErB,IAAI,YAAyB,CAAC;AAC9B,IAAI,SAAsB,CAAC;AAC3B,IAAI,OAAoB,CAAC;AACzB,IAAI,OAAoB,CAAC;AAEzB,IAAI,WAAwB,CAAC;AAG7B,SAAe,IAAI;;QAGf,IAAI,GAAG,MAAM,OAAO,EAAE,CAAC;QAGvB,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;QACjD,cAAc,GAAG,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC;QAC3D,cAAc,CAAC,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,WAAW,EAAE,CAAC,CAAC;QAC9D,aAAa,GAAG,QAAQ,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC;QACzD,aAAa,GAAG,QAAQ,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC;QACzD,YAAY,GAAG,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC;QACvD,YAAY,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC,CAAC,EAAE,CAAC,YAAY,CAAC,gBAAgB,CAAC,CAAC,CAAA;QAC9E,SAAS,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QAC/C,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QAC7C,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,SAAS,CAAC,YAAY,GAAC,CAAC,CAAC,CAAC,CAAC;QACnE,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QAC7C,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,SAAS,CAAC,YAAY,GAAC,CAAC,CAAC,CAAC,CAAC;QACnE,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;QAGrD,eAAe,EAAE,CAAC;QAGlB,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC;IAC1C,CAAC;CAAA;AAID,SAAe,OAAO;;QAElB,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,WAAW,CAAC,CAAC;QAC1C,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE;YACd,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YACnC,OAAO;SACV;QAED,MAAM,MAAM,GAAG,CAAC,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAe,CAAC;QACrD,OAAO,MAAM,CAAC;IAClB,CAAC;CAAA;AAGD,SAAS,QAAQ,CAAC,IAAY,EAAE,UAAsB;IAClD,UAAU,CAAC,WAAW,GAAG,EAAE,CAAC;IAC5B,IAAI,UAAU,GAAG,CAAC,CAAC;IACnB,MAAM,KAAK,GAAG,IAAI,CAAC;IACnB,MAAM,KAAK,GAAG,WAAW,CAAC,GAAG,EAAE;QAE3B,UAAU,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,UAAU,CAAC,CAAC;QAEtD,IAAI,UAAU,IAAI,KAAK,CAAC,MAAM,EAAE;YAC5B,aAAa,CAAC,KAAK,CAAC,CAAC;YACrB,UAAU,aAAV,UAAU,uBAAV,UAAU,EAAI,CAAC;SAClB;IACL,CAAC,EAAE,YAAY,CAAC,CAAC;AACrB,CAAC;AAGD,SAAS,gBAAgB;IACrB,cAAc,CAAC,KAAK,CAAC,OAAO,GAAG,aAAa,CAAC;IAC7C,cAAc,CAAC,OAAO,CAAC,CAAC,EAAE,SAAS,EAAE,YAAY,EAAE,OAAO,EAAE,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,UAAU,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,0BAA0B,EAAE,CAAC,CAAC;AACpK,CAAC;AAGD,SAAS,WAAW;IAChB,aAAa,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IAClD,aAAa,CAAC,YAAY,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC;IACnD,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAEtC,SAAS,CAAC,CAAC,CAAC,CAAC;AACjB,CAAC;AAGD,SAAS,SAAS,CAAC,CAAS;IAExB,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC;QACxC,OAAO;IAEX,YAAY,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;IAEpF,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;IACvC,YAAY,CAAC,SAAS,GAAG,EAAE,CAAC;IAC5B,MAAM,GAAG,GAAG,IAAI,KAAK,EAAE,CAAC;IACxB,GAAG,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,WAAW,GAAG,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC,CAAC;IAC7D,GAAG,CAAC,OAAO,GAAG,MAAM,CAAC;IACrB,GAAG,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC;IACpB,GAAG,CAAC,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE;QAC/B,YAAY,CAAC,SAAS,GAAG,yGAAyG,IAAI,CAAC,IAAI,yCAAyC,CAAC;QACrL,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;IAC/C,CAAC,CAAC,CAAC;IACH,GAAG,CAAC,gBAAgB,CAAC,MAAM,EAAE,GAAG,EAAE,GAAY,CAAC,CAAC,CAAC;IACjD,YAAY,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;IAC9B,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;AAC/C,CAAC;AAED,SAAS,eAAe;IAGpB,IAAI,MAAM,GAAW,IAAI,CAAC;IAC1B,IAAI,SAAS,GAAG,CAAC,CAAC;IAClB,MAAM,QAAQ,GAAG,QAAQ,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;IAErD,QAAQ,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC,CAAC,EAAC,EAAE;QAC7C,MAAM,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QACvB,MAAM,GAAG,CAAC,CAAC,OAAO,CAAC;QACnB,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;IACvB,CAAC,EAAE,EAAC,OAAO,EAAC,IAAI,EAAC,CAAC,CAAC;IAEnB,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC,CAAC,EAAC,EAAE;QAC3C,IAAG,MAAM,KAAK,IAAI;YAAE,OAAO;QAC3B,MAAM,CAAC,GAAG,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;QAC9B,MAAM,EAAE,GAAG,CAAC,CAAC,OAAO,GAAG,MAAM,CAAC;QAC9B,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,SAAS,CAAC;QAClC,MAAM,GAAG,IAAI,CAAC;QACd,IAAG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,EAAC;YAC7B,IAAG,EAAE,GAAG,CAAC;gBAAE,SAAS,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC;;gBAClC,SAAS,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC;SACpC;IACD,CAAC,EAAE,EAAC,OAAO,EAAC,IAAI,EAAC,CAAC,CAAC;IAGnB,IAAI,OAAO,GAAG,CAAC,CAAC;IAChB,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC,CAAC,EAAC,EAAE;QAC3C,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QACvB,IAAG,GAAG,GAAG,OAAO,GAAG,GAAG,EAAC;YAEnB,YAAY,CAAC,gBAAgB,CAAC,CAAC;SAClC;QACD,OAAO,GAAG,GAAG,CAAC;IACd,CAAC,CAAC,CAAC;AACP,CAAC;AAED,SAAS,YAAY,CAAC,CAAS;IAC3B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;QACxB,kBAAkB,CAAC,CAAC,CAAC,CAAC;KACzB;IACD,UAAU,CAAC,GAAG,EAAE;QACZ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YACxB,kBAAkB,CAAC,CAAC,CAAC,CAAC;SACzB;IACL,CAAC,EAAE,IAAI,CAAC,CAAC;IAGT,UAAU,CAAC,GAAG,EAAE,GAAG,WAAW,CAAC,SAAS,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;AAC5D,CAAC;AAED,SAAS,kBAAkB,CAAC,KAAa;IACrC,MAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IACzC,EAAE,CAAC,SAAS,GAAG,eAAe,CAAC;IAC/B,EAAE,CAAC,SAAS,GAAG,IAAI,CAAC;IAEpB,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC;IAC9B,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC;IAClC,MAAM,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC;IACpC,EAAE,CAAC,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC,WAAW,CAAC;IACrC,EAAE,CAAC,KAAK,CAAC,iBAAiB,GAAG,GAAG,GAAG,GAAG,CAAC;IACvC,EAAE,CAAC,KAAK,CAAC,cAAc,GAAG,GAAG,KAAK,GAAG,CAAC;IACtC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC;IACnD,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC;IACrD,WAAW,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;AAChC,CAAC","sourcesContent":["/* ===========================\r\n   CONFIGURAZIONE / TESTO\r\n   ===========================\r\n   Se vuoi cambiare la frase iniziale modifica la variabile `initialMessage`.\r\n   Se vuoi cambiare il percorso del file JSON delle immagini modifica `IMAGES_JSON`.\r\n*/\r\n// const initialMessage = `................................................................................................................................................`;\r\n// const IMAGES_JSON = 'images.json'; // nome del manifest delle immagini (metti nella stessa cartella)\r\n\r\n\r\ninterface DataStruct {\r\n    text: string;\r\n    images: Array<{ file: string, caption: string }>\r\n}\r\n\r\n\r\nconst TYPING_SPEED = 20; // ms per carattere (modifica per velocità)\r\nconst HEART_FALL_COUNT = 100; // numero di cuori nella cascata\r\n\r\n\r\n\r\n\r\nwindow.addEventListener(\"DOMContentLoaded\", e => {\r\n    main();\r\n});\r\n\r\n\r\nlet data: DataStruct;\r\nlet greetingEl: HTMLElement;\r\nlet openGalleryBtn: HTMLElement;\r\nlet welcomeScreen: HTMLElement;\r\nlet galleryScreen: HTMLElement;\r\nlet galleryIndex = 0;\r\n\r\nlet imageWrapper: HTMLElement;\r\nlet captionEl: HTMLElement;\r\nlet prevBtn: HTMLElement;\r\nlet nextBtn: HTMLElement;\r\n\r\nlet heartsLayer: HTMLElement;\r\n\r\n\r\nasync function main() {\r\n\r\n    // legge i dati\r\n    data = await getData();\r\n\r\n    // risolve gli elementi dell'interfaccia\r\n    greetingEl = document.getElementById('greeting');\r\n    openGalleryBtn = document.getElementById('openGalleryBtn');\r\n    openGalleryBtn.addEventListener('click', () => showGallery());\r\n    welcomeScreen = document.getElementById('welcomeScreen');\r\n    galleryScreen = document.getElementById('galleryScreen');\r\n    imageWrapper = document.getElementById('imageWrapper');\r\n    imageWrapper.addEventListener(\"dblclick\", e => launchHearts(HEART_FALL_COUNT))\r\n    captionEl = document.getElementById('caption');\r\n    prevBtn = document.getElementById('prevBtn');\r\n    prevBtn.addEventListener('click', () => showImage(galleryIndex-1));\r\n    nextBtn = document.getElementById('nextBtn');\r\n    nextBtn.addEventListener('click', () => showImage(galleryIndex+1));\r\n    heartsLayer = document.getElementById('heartsLayer');\r\n\r\n    // aggiunge gli eventi di swipe\r\n    addSwipeSupport();\r\n\r\n    // scrive il testo a schermo\r\n    typeText(data.text, onTypingComplete);\r\n}\r\n\r\n\r\n\r\nasync function getData() {\r\n\r\n    const response = await fetch(\"data.json\");\r\n    if (!response.ok) {\r\n        console.error(response.statusText);\r\n        return;\r\n    }\r\n\r\n    const result = (await response.json()) as DataStruct;\r\n    return result;\r\n}\r\n\r\n/* Animazione del testo */\r\nfunction typeText(text: string, onComplete: () => void) {\r\n    greetingEl.textContent = '';\r\n    let typedIndex = 0;\r\n    const words = text;\r\n    const timer = setInterval(() => {\r\n        // aggiunge un carattere alla volta (rispetta gli spazi e i ritorni a capo)\r\n        greetingEl.textContent = words.slice(0, ++typedIndex);\r\n        // Assicura che il testo resti centrato e vada a capo automaticamente grazie al CSS\r\n        if (typedIndex >= words.length) {\r\n            clearInterval(timer);\r\n            onComplete?.();\r\n        }\r\n    }, TYPING_SPEED);\r\n}\r\n\r\n/* Alla fine della digitazione mostra il cuore */\r\nfunction onTypingComplete() {\r\n    openGalleryBtn.style.display = 'inline-flex';\r\n    openGalleryBtn.animate([{ transform: 'scale(0.6)', opacity: 0 }, { transform: 'scale(1)', opacity: 1 }], { duration: 320, easing: 'cubic-bezier(.2,.9,.2,1)' });\r\n}\r\n\r\n\r\nfunction showGallery() {\r\n    welcomeScreen.setAttribute('aria-hidden', 'true');\r\n    galleryScreen.setAttribute('aria-hidden', 'false');\r\n    galleryScreen.classList.add('active');\r\n    // carica immagini (se non caricate)\r\n    showImage(0);\r\n}\r\n\r\n/* Mostra immagine con gestione del caricamento e fallback */\r\nfunction showImage(i: number) {\r\n\r\n    if (!data.images || data.images.length === 0) \r\n        return;\r\n\r\n    galleryIndex = ((i % data.images.length) + data.images.length) % data.images.length;\r\n\r\n    const item = data.images[galleryIndex];\r\n    imageWrapper.innerHTML = ''; // reset\r\n    const img = new Image();\r\n    img.alt = item.caption || ('Immagine ' + (galleryIndex + 1));\r\n    img.loading = 'lazy';\r\n    img.src = item.file;\r\n    img.addEventListener('error', () => {\r\n        imageWrapper.innerHTML = `<div style=\"color:rgba(255,255,255,0.6);text-align:center;padding:20px\">Non riesco a caricare <strong>${item.file}</strong>. Controlla il percorso.</div>`;\r\n        captionEl.textContent = item.caption || '';\r\n    });\r\n    img.addEventListener('load', () => { /* ok */ });\r\n    imageWrapper.appendChild(img);\r\n    captionEl.textContent = item.caption || '';\r\n}\r\n\r\nfunction addSwipeSupport() {\r\n\r\n    /* Swipe support (touch) */\r\n    let startX: number = null;\r\n    let startTime = 0;\r\n    const carousel = document.getElementById('carousel');\r\n\r\n    carousel.addEventListener('touchstart', (e)=>{\r\n    const t = e.touches[0];\r\n    startX = t.clientX;\r\n    startTime = Date.now();\r\n    }, {passive:true});\r\n\r\n    carousel.addEventListener('touchend', (e)=>{\r\n    if(startX === null) return;\r\n    const t = e.changedTouches[0];\r\n    const dx = t.clientX - startX;\r\n    const dt = Date.now() - startTime;\r\n    startX = null;\r\n    if(Math.abs(dx) > 40 && dt < 600){\r\n        if(dx < 0) showImage(galleryIndex + 1);\r\n        else showImage(galleryIndex - 1);\r\n    }\r\n    }, {passive:true});\r\n\r\n    /* Doppio tocco per la cascata di cuori */\r\n    let lastTap = 0;\r\n    carousel.addEventListener('touchend', (e)=>{\r\n    const now = Date.now();\r\n    if(now - lastTap < 300){\r\n        // doppio tap\r\n        launchHearts(HEART_FALL_COUNT);\r\n    }\r\n    lastTap = now;\r\n    });\r\n}\r\n\r\nfunction launchHearts(n: number) {\r\n    for (let k = 0; k < n; k++) {\r\n        createFallingHeart(k);\r\n    }\r\n    setTimeout(() => {\r\n        for (let k = 0; k < n; k++) {\r\n            createFallingHeart(k);\r\n        }\r\n    }, 1000);\r\n\r\n    // rimuove i cuori dopo 6s per pulizia\r\n    setTimeout(() => { heartsLayer.innerHTML = ''; }, 6500);\r\n}\r\n\r\nfunction createFallingHeart(index: number) {\r\n    const el = document.createElement('div');\r\n    el.className = 'falling-heart';\r\n    el.innerText = '❤️';\r\n    // posizioni e durata casuali\r\n    const x = Math.random() * 100; // percent\r\n    const delay = Math.random() * 1.2; // sec\r\n    const dur = 3 + Math.random() * 2.2; // sec\r\n    el.style.left = `calc(${x}% - 20px)`;\r\n    el.style.animationDuration = `${dur}s`;\r\n    el.style.animationDelay = `${delay}s`;\r\n    el.style.fontSize = `${12 + Math.random() * 28}px`;\r\n    el.style.opacity = String(0.7 + Math.random() * 0.3);\r\n    heartsLayer.appendChild(el);\r\n}\r\n\r\n"]}